<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= content_for?(:title) ? "#{yield(:title)} — GrailSearch" : "GrailSearch — Find Your Grails Across Every Resale Platform" %></title>
  <meta name="description" content="<%= content_for?(:meta_description) ? yield(:meta_description) : "Search Vinted, eBay, Depop, Grailed, Vestiaire Collective & Poshmark in one place. Find rare clothing, discontinued shoes, and fashion grails." %>">
  <meta name="keywords" content="grail finder, search resale platforms, vinted search, depop search, grailed search, find rare clothing, secondhand fashion, find discontinued clothes, fashion search engine, resale aggregator">
  <link rel="canonical" href="<%= request.original_url.split('?').first %>">

  <!-- Open Graph -->
  <meta property="og:title" content="<%= content_for?(:title) ? "#{yield(:title)} — GrailSearch" : "GrailSearch — Find Your Grails" %>">
  <meta property="og:description" content="<%= content_for?(:meta_description) ? yield(:meta_description) : "Search all resale platforms at once. Find rare clothing, shoes & fashion items." %>">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="GrailSearch">
  <meta property="og:url" content="<%= request.original_url %>">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="<%= content_for?(:title) ? "#{yield(:title)} — GrailSearch" : "GrailSearch — Find Your Grails" %>">
  <meta name="twitter:description" content="<%= content_for?(:meta_description) ? yield(:meta_description) : "Search all resale platforms at once. Find rare clothing, shoes & fashion items." %>">

  <!-- Structured Data: Organization -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "GrailSearch",
    "url": "<%= root_url %>",
    "description": "Search Vinted, eBay, Depop, Grailed, Vestiaire Collective & Poshmark in one place. Find rare clothing, discontinued shoes, and fashion grails.",
    "applicationCategory": "ShoppingApplication",
    "operatingSystem": "Web",
    "offers": {
      "@type": "AggregateOffer",
      "lowPrice": "0",
      "highPrice": "8",
      "priceCurrency": "EUR",
      "offerCount": "2"
    }
  }
  </script>

  <%= yield(:structured_data) %>

  <script src="https://cdn.tailwindcss.com"></script>
  <%= javascript_importmap_tags %>
</head>
<body class="h-full bg-white text-gray-900 antialiased">
  <nav class="border-b border-gray-100">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex h-16 items-center justify-between">
        <a href="/" class="text-xl font-bold tracking-tight shrink-0">
          <span class="text-black">Grail</span><span class="text-indigo-600">Search</span>
        </a>
        <div class="flex items-center gap-2 sm:gap-4 text-sm">
          <a href="<%= search_path %>" class="hidden sm:inline text-gray-600 hover:text-gray-900">Search</a>
          <a href="<%= pricing_path %>" class="text-gray-600 hover:text-gray-900">Pricing</a>
          <% if logged_in? %>
            <a href="<%= saved_searches_path %>" class="text-gray-600 hover:text-gray-900">My Searches</a>
            <% if current_user.free? %>
              <a href="<%= pricing_path %>" class="hidden sm:inline text-indigo-600 font-medium hover:text-indigo-800">Upgrade ✨</a>
            <% end %>
            <span class="hidden sm:inline text-gray-400"><%= current_user.name %></span>
            <%= button_to "Log out", logout_path, method: :delete, class: "text-gray-500 hover:text-gray-700" %>
          <% else %>
            <a href="<%= login_path %>" class="text-gray-600 hover:text-gray-900">Log in</a>
            <a href="<%= signup_path %>" class="rounded-full bg-black px-3 py-1.5 sm:px-4 sm:py-2 text-white text-sm font-medium hover:bg-gray-800 transition whitespace-nowrap">Sign up free</a>
          <% end %>
        </div>
      </div>
    </div>
  </nav>

  <% if flash[:notice] %>
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 mt-4">
      <div class="rounded-lg bg-green-50 p-4 text-green-800 text-sm"><%= flash[:notice] %></div>
    </div>
  <% end %>
  <% if flash[:alert] %>
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 mt-4">
      <div class="rounded-lg bg-red-50 p-4 text-red-800 text-sm"><%= flash[:alert] %></div>
    </div>
  <% end %>

  <main>
    <%= yield %>
  </main>

  <footer class="mt-24 border-t border-gray-100 py-12">
    <div class="mx-auto max-w-7xl px-4">
      <div class="grid gap-8 sm:grid-cols-3 text-sm text-gray-400">
        <div>
          <p class="font-semibold text-gray-600">GrailSearch</p>
          <p class="mt-2">The fastest way to find rare fashion across every resale platform.</p>
        </div>
        <div>
          <p class="font-semibold text-gray-600">Platforms</p>
          <p class="mt-2">eBay · Vinted · Depop · Grailed · Vestiaire Collective · Poshmark</p>
        </div>
        <div>
          <p class="font-semibold text-gray-600">Product</p>
          <div class="mt-2 flex flex-col gap-1">
            <a href="<%= search_path %>" class="hover:text-gray-600">Search</a>
            <a href="<%= pricing_path %>" class="hover:text-gray-600">Pricing</a>
            <a href="<%= signup_path %>" class="hover:text-gray-600">Sign up</a>
          </div>
        </div>
      </div>
      <div class="mt-8 pt-8 border-t border-gray-100 text-center text-sm text-gray-400">
        <p>&copy; <%= Date.today.year %> GrailSearch. Search smarter, find your grails.</p>
        <p class="mt-1">Not affiliated with eBay, Vinted, Depop, Grailed, Vestiaire Collective, or Poshmark.</p>
      </div>
    </div>
  </footer>
</body>
</html>
